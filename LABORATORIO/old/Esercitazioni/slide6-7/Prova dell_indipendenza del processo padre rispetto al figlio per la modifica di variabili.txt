#include “apue.h”
int glob=6; /* variabile esterna (blocco dati inizializzati) */ 
char buf[] = “una write sullo stdout\n”;
int main(void)
{
int var; /* variabile automatica sullo stack */ pid_t pid;
var = 88;
if (write(STDOUT_FILENO,buf, sizeof(buf)-1) != sizeof(buf)-1) 
err_sys(“errore della write”);
printf(“prima della fork\n”);
if ((pid = fork())<0) { 
err_sys(“errore della fork”);
} 
else if (pid ==0){	/* figlio */
glob++;	/* modifica le variabili */ var++;
} 
else {
sleep(2);	/* padre */
}
printf(“pid = %d, glob = %d, var = %d\n”,getpid(),glob,var); 
exit(0);
}
